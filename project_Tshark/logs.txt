arguments: C:\\Program_Code\\C++\\project_Tshark\\x64\\Debug\\project_Tshark.exe
Current dir: C:\Program_Code\C++\project_Tshark\project_Tshark
File verbosity level: 9
date       time         ( uptime  ) [ thread name/id ]                   file:line     v| 
2025-04-11 21:17:44.990 (   0.883s) [main thread     ]             loguru.cpp:841   INFO| Logging to 'logs.txt', mode: 'w', verbosity: 9
2025-04-11 21:17:52.720 (   8.613s) [         7E1209B]     project_Tshark.cpp:39    INFO| Request received for /api/getAdaptersList
2025-04-11 21:17:53.169 (   9.062s) [         7E1209B]     project_Tshark.cpp:52    INFO| Received response with status 200
2025-04-11 21:18:06.166 (  22.059s) [        CF604A0D]     project_Tshark.cpp:39    INFO| Request received for /api/startCapture
2025-04-11 21:18:06.169 (  22.062s) [        CF604A0D]      TsharkManager.cpp:805   INFO| reset called
2025-04-11 21:18:06.184 (  22.077s) [        CF604A0D]      TsharkManager.cpp:356   INFO| 即將開始抓包，網路卡：\Device\NPF_{AFB90727-75CB-4D83-B303-E9734ACB117B}
2025-04-11 21:18:06.187 (  22.080s) [        CF604A0D]     project_Tshark.cpp:52    INFO| Received response with status 200
2025-04-11 21:18:13.049 (  28.942s) [        7FA6DF13]     project_Tshark.cpp:39    INFO| Request received for /api/stopCapture
2025-04-11 21:18:13.052 (  28.945s) [        7FA6DF13]      TsharkManager.cpp:373   INFO| 即將停止抓包
2025-04-11 21:18:14.169 (  30.062s) [        7FA6DF13]     project_Tshark.cpp:52    INFO| Received response with status 200
2025-04-11 21:18:40.596 (  56.489s) [        E8A6AA82]     project_Tshark.cpp:39    INFO| Request received for /api/getPakcetList
2025-04-11 21:18:40.601 (  56.494s) [        E8A6AA82]           querySQL.hpp:59    INFO| [BUILD SQL]: SELECT * FROM t_packets LIMIT 100 OFFSET 0;
2025-04-11 21:18:40.605 (  56.498s) [        E8A6AA82]           querySQL.hpp:59    INFO| [BUILD SQL]: SELECT * FROM t_packets LIMIT 100 OFFSET 0;
2025-04-11 21:18:40.609 (  56.502s) [        E8A6AA82]           querySQL.hpp:71    INFO| [BUILD SQL]: SELECT COUNT(0) FROM (SELECT * FROM t_packets ) t_temp
2025-04-11 21:18:40.615 (  56.508s) [        E8A6AA82]     project_Tshark.cpp:52    INFO| Received response with status 200
2025-04-11 21:18:55.553 (  71.446s) [        D4009166]     project_Tshark.cpp:39    INFO| Request received for /api/getSessionList
2025-04-11 21:18:55.557 (  71.450s) [        D4009166]           querySQL.hpp:117   INFO| [BUILD SQL]: SELECT * FROM t_sessions LIMIT 100 OFFSET 0;
2025-04-11 21:18:55.561 (  71.454s) [        D4009166]           querySQL.hpp:117   INFO| [BUILD SQL]: SELECT * FROM t_sessions LIMIT 100 OFFSET 0;
2025-04-11 21:18:55.564 (  71.457s) [        D4009166]           querySQL.hpp:129   INFO| [BUILD SQL]: SELECT COUNT(0) FROM (SELECT * FROM t_sessions ) t_temp
2025-04-11 21:18:55.569 (  71.462s) [        D4009166]     project_Tshark.cpp:52    INFO| Received response with status 200
2025-04-11 21:19:00.424 (  76.317s) [        D4009166]     project_Tshark.cpp:39    INFO| Request received for /api/getIPStatsList
2025-04-11 21:19:00.427 (  76.320s) [        D4009166]           querySQL.hpp:193   INFO| [BUILD SQL]: SELECT
			ip,
			location,
			MIN(start_time) AS earliest_time,
			MAX(end_time) AS latest_time,
			GROUP_CONCAT(DISTINCT port) AS ports,
			GROUP_CONCAT(DISTINCT trans_proto) AS trans_protos,
			GROUP_CONCAT(DISTINCT app_proto) AS app_protos,
			SUM(sent_packets) AS total_sent_packets,
			SUM(sent_bytes) AS total_sent_bytes,
			SUM(recv_packets) AS total_recv_packets,
			SUM(recv_bytes) AS total_recv_bytes,
			SUM(tcp_sessions) AS tcp_session_count,
			SUM(udp_sessions) AS udp_session_count
			FROM(
				SELECT
				ip1 AS ip,
				ip1_location AS location,
				start_time,
				end_time,
				ip1_port AS port,
				trans_proto,
				app_proto,
				ip1_send_packets_count AS sent_packets,
				ip1_send_bytes_count AS sent_bytes,
				ip2_send_packets_count AS recv_packets,
				ip2_send_bytes_count AS recv_bytes,
				CASE WHEN trans_proto LIKE '%TCP%' THEN 1 ELSE 0 END AS tcp_sessions,
				CASE WHEN trans_proto LIKE '%UDP%' THEN 1 ELSE 0 END AS udp_sessions
				FROM t_sessions
				UNION ALL
				SELECT
				ip2 AS ip,
				ip2_location AS location,
				start_time,
				end_time,
				ip2_port AS port,
				trans_proto,
				app_proto,
				ip2_send_packets_count AS sent_packets,
				ip2_send_bytes_count AS sent_bytes,
				ip1_send_packets_count AS recv_packets,
				ip1_send_bytes_count AS recv_bytes,
				CASE WHEN trans_proto LIKE '%TCP%' THEN 1 ELSE 0 END AS tcp_sessions,
				CASE WHEN trans_proto LIKE '%UDP%' THEN 1 ELSE 0 END AS udp_sessions
				FROM t_sessions
			) t
			GROUP BY ip LIMIT 100 OFFSET 0;
2025-04-11 21:19:00.459 (  76.352s) [        D4009166]           querySQL.hpp:193   INFO| [BUILD SQL]: SELECT
			ip,
			location,
			MIN(start_time) AS earliest_time,
			MAX(end_time) AS latest_time,
			GROUP_CONCAT(DISTINCT port) AS ports,
			GROUP_CONCAT(DISTINCT trans_proto) AS trans_protos,
			GROUP_CONCAT(DISTINCT app_proto) AS app_protos,
			SUM(sent_packets) AS total_sent_packets,
			SUM(sent_bytes) AS total_sent_bytes,
			SUM(recv_packets) AS total_recv_packets,
			SUM(recv_bytes) AS total_recv_bytes,
			SUM(tcp_sessions) AS tcp_session_count,
			SUM(udp_sessions) AS udp_session_count
			FROM(
				SELECT
				ip1 AS ip,
				ip1_location AS location,
				start_time,
				end_time,
				ip1_port AS port,
				trans_proto,
				app_proto,
				ip1_send_packets_count AS sent_packets,
				ip1_send_bytes_count AS sent_bytes,
				ip2_send_packets_count AS recv_packets,
				ip2_send_bytes_count AS recv_bytes,
				CASE WHEN trans_proto LIKE '%TCP%' THEN 1 ELSE 0 END AS tcp_sessions,
				CASE WHEN trans_proto LIKE '%UDP%' THEN 1 ELSE 0 END AS udp_sessions
				FROM t_sessions
				UNION ALL
				SELECT
				ip2 AS ip,
				ip2_location AS location,
				start_time,
				end_time,
				ip2_port AS port,
				trans_proto,
				app_proto,
				ip2_send_packets_count AS sent_packets,
				ip2_send_bytes_count AS sent_bytes,
				ip1_send_packets_count AS recv_packets,
				ip1_send_bytes_count AS recv_bytes,
				CASE WHEN trans_proto LIKE '%TCP%' THEN 1 ELSE 0 END AS tcp_sessions,
				CASE WHEN trans_proto LIKE '%UDP%' THEN 1 ELSE 0 END AS udp_sessions
				FROM t_sessions
			) t
			GROUP BY ip LIMIT 100 OFFSET 0;
2025-04-11 21:19:00.489 (  76.382s) [        D4009166]           querySQL.hpp:205   INFO| [BUILD SQL]: SELECT COUNT(0) FROM (SELECT
			ip,
			location,
			MIN(start_time) AS earliest_time,
			MAX(end_time) AS latest_time,
			GROUP_CONCAT(DISTINCT port) AS ports,
			GROUP_CONCAT(DISTINCT trans_proto) AS trans_protos,
			GROUP_CONCAT(DISTINCT app_proto) AS app_protos,
			SUM(sent_packets) AS total_sent_packets,
			SUM(sent_bytes) AS total_sent_bytes,
			SUM(recv_packets) AS total_recv_packets,
			SUM(recv_bytes) AS total_recv_bytes,
			SUM(tcp_sessions) AS tcp_session_count,
			SUM(udp_sessions) AS udp_session_count
			FROM(
				SELECT
				ip1 AS ip,
				ip1_location AS location,
				start_time,
				end_time,
				ip1_port AS port,
				trans_proto,
				app_proto,
				ip1_send_packets_count AS sent_packets,
				ip1_send_bytes_count AS sent_bytes,
				ip2_send_packets_count AS recv_packets,
				ip2_send_bytes_count AS recv_bytes,
				CASE WHEN trans_proto LIKE '%TCP%' THEN 1 ELSE 0 END AS tcp_sessions,
				CASE WHEN trans_proto LIKE '%UDP%' THEN 1 ELSE 0 END AS udp_sessions
				FROM t_sessions
				UNION ALL
				SELECT
				ip2 AS ip,
				ip2_location AS location,
				start_time,
				end_time,
				ip2_port AS port,
				trans_proto,
				app_proto,
				ip2_send_packets_count AS sent_packets,
				ip2_send_bytes_count AS sent_bytes,
				ip1_send_packets_count AS recv_packets,
				ip1_send_bytes_count AS recv_bytes,
				CASE WHEN trans_proto LIKE '%TCP%' THEN 1 ELSE 0 END AS tcp_sessions,
				CASE WHEN trans_proto LIKE '%UDP%' THEN 1 ELSE 0 END AS udp_sessions
				FROM t_sessions
			) t
			GROUP BY ip ) t_temp
2025-04-11 21:19:00.522 (  76.415s) [        D4009166]     project_Tshark.cpp:52    INFO| Received response with status 200
2025-04-11 21:19:03.866 (  79.759s) [        D4009166]     project_Tshark.cpp:39    INFO| Request received for /api/getProtoStatsList
2025-04-11 21:19:03.869 (  79.762s) [        D4009166]           querySQL.hpp:232   INFO| [BUILD SQL]: SELECT
				protocol,
				SUM(packet_count) AS totalPackets,
				SUM(total_bytes) AS total_bytes,
				COUNT(DISTINCT session_id) AS sessionCount
			FROM (
				SELECT session_id, trans_proto AS protocol, packet_count, total_bytes
				FROM t_sessions
				WHERE trans_proto IS NOT NULL AND trans_proto != ''
				UNION ALL
				SELECT session_id, app_proto AS protocol, packet_count, total_bytes
				FROM t_sessions
				WHERE app_proto IS NOT NULL AND app_proto != ''
			) AS combined
			GROUP BY protocol LIMIT 100 OFFSET 0;
2025-04-11 21:19:03.883 (  79.776s) [        D4009166]           querySQL.hpp:232   INFO| [BUILD SQL]: SELECT
				protocol,
				SUM(packet_count) AS totalPackets,
				SUM(total_bytes) AS total_bytes,
				COUNT(DISTINCT session_id) AS sessionCount
			FROM (
				SELECT session_id, trans_proto AS protocol, packet_count, total_bytes
				FROM t_sessions
				WHERE trans_proto IS NOT NULL AND trans_proto != ''
				UNION ALL
				SELECT session_id, app_proto AS protocol, packet_count, total_bytes
				FROM t_sessions
				WHERE app_proto IS NOT NULL AND app_proto != ''
			) AS combined
			GROUP BY protocol LIMIT 100 OFFSET 0;
2025-04-11 21:19:03.898 (  79.791s) [        D4009166]           querySQL.hpp:244   INFO| [BUILD SQL]: SELECT COUNT(0) FROM (SELECT
				protocol,
				SUM(packet_count) AS totalPackets,
				SUM(total_bytes) AS total_bytes,
				COUNT(DISTINCT session_id) AS sessionCount
			FROM (
				SELECT session_id, trans_proto AS protocol, packet_count, total_bytes
				FROM t_sessions
				WHERE trans_proto IS NOT NULL AND trans_proto != ''
				UNION ALL
				SELECT session_id, app_proto AS protocol, packet_count, total_bytes
				FROM t_sessions
				WHERE app_proto IS NOT NULL AND app_proto != ''
			) AS combined
			GROUP BY protocol ) t_temp
2025-04-11 21:19:03.915 (  79.808s) [        D4009166]     project_Tshark.cpp:52    INFO| Received response with status 200
